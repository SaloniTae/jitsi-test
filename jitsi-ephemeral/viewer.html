<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Viewer</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<script src="https://8x8.vc/vpaas-magic-cookie-45b14c029c1e43698634a0ad0d0838a9/external_api.js"></script>
<style>
  :root { --bg:#000; --text:#e6f0f3; }
  html,body{height:100%;margin:0;font-family:system-ui,Arial,sans-serif;
            background:var(--bg);color:var(--text);overflow:hidden;}
  #jaas{height:100vh;width:100vw;background:var(--bg);position:relative;overflow:hidden;}
  .viewer-controls{position:absolute;right:12px;top:12px;z-index:9999;display:none;gap:8px;}
  .viewer-controls button{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.06);
                          padding:8px 10px;border-radius:6px;color:var(--text);cursor:pointer;font-size:13px;}
  .force-landscape{position:fixed!important;top:50%!important;left:50%!important;width:100vh!important;height:100vw!important;
                   transform:translate(-50%,-50%) rotate(90deg)!important;transform-origin:center!important;z-index:99999!important;
                   background:var(--bg)!important;}
</style>
</head>
<body>
  <div id="jaas"><div class="viewer-controls" id="viewerControls"><button id="btnFullscreen">Fullscreen</button></div></div>

<script>
(function(){
  /* ---- ROOM injected by server ---- */
  const APP_ID = "vpaas-magic-cookie-45b14c029c1e43698634a0ad0d0838a9";
  const ROOM   = `${APP_ID}/%%ROOM_PLACEHOLDER%%`;
  const DOMAIN = "8x8.vc";
  const JWT    = "";

  let api=null,isCSS=false;

  function isMobileSmall(){
    try{return (('ontouchstart'in window)||navigator.maxTouchPoints>0)&&window.innerWidth<=900;}catch(e){return false;}
  }
  function cssOn(){if(!isMobileSmall()||isCSS)return;const j=document.getElementById('jaas');
    j&&(document.body.style.overflow='hidden',j.classList.add('force-landscape'),isCSS=true);}
  function cssOff(){if(!isCSS)return;const j=document.getElementById('jaas');
    j&&(j.classList.remove('force-landscape'),document.body.style.overflow='',isCSS=false);}
  async function lock(o){if(screen.orientation&&screen.orientation.lock) return screen.orientation.lock(o);
    const f=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;if(f)return f.call(screen,o);
    throw'no lock';}
  async function enterFS(){
    const el=document.getElementById('jaas');
    if(el.requestFullscreen) await el.requestFullscreen();
    else if(el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
    else if(el.msRequestFullscreen) await el.msRequestFullscreen();
    try{await lock('landscape');cssOff();}catch(e){cssOn();}
  }
  async function exitFS(){
    if(document.exitFullscreen) await document.exitFullscreen();
    else if(document.webkitExitFullscreen) await document.webkitExitFullscreen();
    else if(document.msExitFullscreen) await document.msExitFullscreen();
    cssOff();
  }
  function toggleFS(){!document.fullscreenElement&& !document.webkitFullscreenElement&& !document.msFullscreenElement
                     ?enterFS():exitFS();}
  document.addEventListener('fullscreenchange',cssOff);
  document.addEventListener('webkitfullscreenchange',cssOff);
  document.addEventListener('msfullscreenchange',cssOff);

  function init(){
    if(api) return;
    const opts={
      roomName:ROOM,parentNode:document.getElementById('jaas'),
      userInfo:{displayName:'Viewer'},
      configOverwrite:{
        prejoinConfig:{enabled:false},disableInitialGUM:true,
        startWithAudioMuted:true,startWithVideoMuted:true,
        filmstrip:{disabled:true}
      },
      interfaceConfigOverwrite:{TOOLBAR_BUTTONS:[],SHOW_JITSI_WATERMARK:false,
        SHOW_BRAND_WATERMARK:false,SHOW_POWERED_BY:false},
      width:'100%',height:'100%'
    };
    if(JWT) opts.jwt=JWT;

    api=new JitsiMeetExternalAPI(DOMAIN,opts);

    api.addEventListener('videoConferenceJoined',()=>document.getElementById('viewerControls').style.display='flex');
    api.addEventListener('videoConferenceLeft', ()=>document.getElementById('viewerControls').style.display='none');
  }

  window.addEventListener('load',()=>{
    init();
    document.getElementById('btnFullscreen').addEventListener('click',toggleFS);
  });
})();
</script>
</body>
</html>
