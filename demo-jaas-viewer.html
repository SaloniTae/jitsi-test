<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Jitsi — Only Fullscreen</title>
    <script src="https://8x8.vc/vpaas-magic-cookie-45b14c029c1e43698634a0ad0d0838a9/external_api.js" async></script>
    <style>
      html, body, #jaas-container { height: 100%; margin: 0; }
      /* Floating fallback fullscreen button (visible if built-in button isn't available) */
      #fullscreen-fallback {
        position: fixed;
        right: 18px;
        bottom: 18px;
        z-index: 99999;
        background: rgba(0,0,0,0.6);
        color: #fff;
        border: none;
        padding: 10px 14px;
        font-size: 14px;
        border-radius: 8px;
        cursor: pointer;
        display: none; /* show only when needed */
      }
      /* If Jitsi still shows a toolbox, make sure it only contains the fullscreen button.
         This is a gentle fallback — if the host forces buttons, the server may override. */
      #jaas-container .toolbox {
        /* keep toolbox visible (so built-in fullscreen can remain) but prevent overflow */
        pointer-events: auto;
      }
    </style>
  </head>
  <body>
    <div id="jaas-container"></div>
    <button id="fullscreen-fallback" aria-label="Fullscreen (fallback)">⤢ Fullscreen</button>

    <script type="text/javascript">
      // Configuration - paste your JWT/room etc.
      const jwt = "eyJraWQiOiJ2cGFhcy1tYWdpYy1jb29raWUtNDViMTRjMDI5YzFlNDM2OTg2MzRhMGFkMGQwODM4YTkvNjM4ODg2LVNBTVBMRV9BUFAiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJqaXRzaSIsImlzcyI6ImNoYXQiLCJpYXQiOjE3NTkxNzIyMDMsImV4cCI6MTc1OTE3OTQwMywibmJmIjoxNzU5MTcyMTk4LCJzdWIiOiJ2cGFhcy1tYWdpYy1jb29raWUtNDViMTRjMDI5YzFlNDM2OTg2MzRhMGFkMGQwODM4YTkiLCJjb250ZXh0Ijp7ImZlYXR1cmVzIjp7ImxpdmVzdHJlYW1pbmciOmZhbHNlLCJmaWxlLXVwbG9hZCI6ZmFsc2UsIm91dGJvdW5kLWNhbGwiOmZhbHNlLCJzaXAtb3V0Ym91bmQtY2FsbCI6ZmFsc2UsInRyYW5zY3JpcHRpb24iOmZhbHNlLCJsaXN0LXZpc2l0b3JzIjpmYWxzZSwicmVjb3JkaW5nIjpmYWxzZSwiZmxpcCI6ZmFsc2V9LCJ1c2VyIjp7ImhpZGRlbi1mcm9tLXJlY29yZGVyIjpmYWxzZSwibW9kZXJhdG9yIjp0cnVlLCJuYW1lIjoiVGVzdCBVc2VyIiwiaWQiOiJnb29nbGUtb2F1dGgyfDEwMzk5Mzc3MDU4OTQ2MjU2NDg5NyIsImF2YXRhciI6IiIsImVtYWlsIjoidGVzdC51c2VyQGNvbXBhbnkuY29tIn19LCJyb29tIjoiKiJ9.bwsvCWjpY07io0W2Iv1kj7If3RlTaEoAHQUqIVXOBb70UFkc8zEC9n4c-BJqw68N-BdIjS_y_TuDGy01SmTv98nSbFr7HF6L8X1zuPYwB-c-FoyVq-_OHxE3MvBDZ9jftoHClMX8f8EhwhNaCv07mlzCEwtya1E6uMMYb0MWmEnZ_QLabQuyy_BWE0eXuAPwhNKJKcxe5SyU_zhdlcQgSM9kA29a6gZLo8qnF8EQuJRw8KEEhaGR7Ixm958lTCAgyRZ9isXl9CITNjxAwn2dk7oPUHl8c59ohYWQ5MYEOtO2TOKQFGibczioqsyr9yIz6yb5ZuUsHkZMkJaZ_9KGkA";

      window.onload = () => {
        const domain = "8x8.vc";
        const options = {
          roomName: "vpaas-magic-cookie-45b14c029c1e43698634a0ad0d0838a9/Ayush37299",
          parentNode: document.querySelector('#jaas-container'),
          jwt,
          configOverwrite: {
            prejoinPageEnabled: false,
            disableInitialGUM: true,
            startWithAudioMuted: true,
            startWithVideoMuted: true,
            // best-effort filmstrip hide (may need toggle below)
            filmstrip: { disabled: true }
          },
          // primary method: request the toolbar to only include fullscreen
          interfaceConfigOverwrite: {
            TOOLBAR_BUTTONS: ['fullscreen'],
            DEFAULT_BACKGROUND: "#336699",
            VERTICAL_FILMSTRIP: false
          }
        };

        const api = new JitsiMeetExternalAPI(domain, options);

        // Hide filmstrip on join (extra attempt)
        api.addEventListener('videoConferenceJoined', () => {
          try {
            api.executeCommand('toggleFilmStrip');
          } catch (e) {
            console.warn("toggleFilmStrip command failed:", e);
          }

          // Check whether the internal fullscreen button exists. If not, show fallback button.
          setTimeout(() => {
            const builtInFS = document.querySelector('#jaas-container .toolbox [data-id="fullscreen"]') ||
                              document.querySelector('#jaas-container .toolbox [aria-label*="Full"]') ||
                              document.querySelector('#jaas-container .toolbox .fullscreen');
            if (!builtInFS) {
              // show fallback
              document.getElementById('fullscreen-fallback').style.display = 'block';
            } else {
              // If built-in fullscreen present, hide the fallback (in case it was visible)
              document.getElementById('fullscreen-fallback').style.display = 'none';
            }
          }, 800);
        });

        // Fallback button behavior
        const fallbackBtn = document.getElementById('fullscreen-fallback');
        fallbackBtn.addEventListener('click', () => {
          try {
            api.executeCommand('toggleFullscreen');
          } catch (e) {
            // As a last resort, try to request browser fullscreen for the container
            const el = document.getElementById('jaas-container');
            if (el.requestFullscreen) el.requestFullscreen();
            else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
            else console.warn('Fullscreen not available:', e);
          }
        });

        // Extra defensive CSS removal: hide any toolbar buttons not labeled fullscreen (best-effort)
        // NOTE: hosts may override CSS; this is a gentle attempt.
        setTimeout(() => {
          const toolbox = document.querySelector('#jaas-container .toolbox');
          if (toolbox) {
            const children = Array.from(toolbox.querySelectorAll('button, a'));
            children.forEach(btn => {
              const label = (btn.getAttribute('aria-label') || btn.title || '').toLowerCase();
              const id = (btn.id || '').toLowerCase();
              if (!label.includes('full') && !id.includes('full')) {
                btn.style.display = 'none';
              } else {
                btn.style.display = ''; // keep fullscreen-like buttons visible
              }
            });
          } else {
            // if no toolbox found, show fallback button
            document.getElementById('fullscreen-fallback').style.display = 'block';
          }
        }, 1000);
      };
    </script>
  </body>
</html>
